<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>SAP S/4HANA Online RFP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f7fa; padding:20px; }
    h1 { text-align:center; color:#0a6ed1; }
    .section { background:#fff; padding:20px; margin:20px auto; max-width:900px; border-radius:8px; }
    label { font-weight:bold; }
    select, textarea, button {
      width:100%; padding:10px; margin-top:8px; margin-bottom:15px;
    }
    button {
      background:#0a6ed1; color:#fff; border:none; border-radius:6px;
      cursor:pointer; font-size:16px;
    }
    button:hover { background:#084b9a; }
    #result { background:#e8f0fe; }
  </style>
</head>

<body>

<h1>SAP S/4HANA – Scope Discovery RFP</h1>

<div class="section">
  <h2>Genel</h2>

  <label>Şirket çoklu lokasyonda mı?</label>
  <select id="multiLocation">
    <option>Evet</option>
    <option>Hayır</option>
  </select>

  <label>Uluslararası operasyon var mı?</label>
  <select id="international">
    <option>Evet</option>
    <option>Hayır</option>
  </select>
</div>

<div class="section">
  <h2>Finans (FI / CO)</h2>

  <label>Çoklu para birimi gerekiyor mu?</label>
  <select id="currency">
    <option>Evet</option>
    <option>Hayır</option>
  </select>

  <label>Yönetimsel ve yasal raporlama ayrımı?</label>
  <select id="reporting">
    <option>Evet</option>
    <option>Hayır</option>
  </select>
</div>

<div class="section">
  <h2>Lojistik (MM / SD)</h2>

  <label>Onaylı satın alma süreçleri var mı?</label>
  <select id="procurement">
    <option>Evet</option>
    <option>Hayır</option>
  </select>

  <label>Depo bazlı stok takibi?</label>
  <select id="warehouse">
    <option>Evet</option>
    <option>Hayır</option>
  </select>
</div>

<div class="section">
  <h2>Üretim</h2>

  <label>Üretim ve maliyet takibi yapılıyor mu?</label>
  <select id="production">
    <option>Evet</option>
    <option>Hayır</option>
  </select>
</div>

<div class="section">
  <button onclick="calculate()">Sonuçları Göster</button>
  <button onclick="exportExcel()">Excel’e Aktar</button>
</div>

<div id="result" class="section"></div>

<script>
function calculate() {
  let modules = ["FI", "CO"];
  let cloud = "S/4HANA Cloud Public Edition";
  let complexity = 1;

  if (multiLocation.value === "Evet") complexity++;
  if (international.value === "Evet") complexity++;
  if (currency.value === "Evet") complexity++;
  if (reporting.value === "Evet") complexity++;

  if (procurement.value === "Evet") modules.push("MM");
  if (warehouse.value === "Evet") { modules.push("EWM"); complexity++; }
  if (production.value === "Evet") { modules.push("PP"); complexity++; }

  if (complexity >= 4) cloud = "S/4HANA Private Cloud";

  let level = complexity <= 2 ? "Low" : complexity <= 4 ? "Medium" : "High";

  document.getElementById("result").innerHTML = `
    <h2>Önerilen SAP Kapsamı</h2>
    <p><b>Modüller:</b> ${modules.join(", ")}</p>
    <p><b>Önerilen Platform:</b> ${cloud}</p>
    <p><b>Proje Karmaşıklığı:</b> ${level}</p>
  `;
}

function exportExcel() {
  let data = [
    ["Soru", "Cevap"],
    ["Çoklu lokasyon", multiLocation.value],
    ["Uluslararası operasyon", international.value],
    ["Çoklu para birimi", currency.value],
    ["Raporlama ayrımı", reporting.value],
    ["Satın alma süreci", procurement.value],
    ["Depo takibi", warehouse.value],
    ["Üretim", production.value]
  ];

  let wb = XLSX.utils.book_new();
  let ws = XLSX.utils.aoa_to_sheet(data);
  XLSX.utils.book_append_sheet(wb, ws, "SAP RFP");
  XLSX.writeFile(wb, "SAP_S4HANA_RFP.xlsx");
}
</script>

</body>
</html>
