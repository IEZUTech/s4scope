<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S4Scope – SAP S/4HANA RFP Manager | IEZU Tech</title>
    <style>
        :root {
            --primary: #0d47a1;
            --secondary: #1a237e;
            --accent: #00c853;
            --bg: #f0f2f5;
            --card: #ffffff;
            --text: #2c3e50;
            --border: #dee2e6;
        }

        /* TEMA VE YERLEŞİM */
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            background: var(--bg); 
            margin: 0; 
            display: flex; 
        }

        /* ÜST İLERLEME ÇUBUĞU */
        #progress-container { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 5px; 
            background: #ddd; 
            z-index: 2000; 
        }
        #progress-bar { 
            height: 100%; 
            width: 0%; 
            background: var(--accent); 
            transition: 0.4s; 
        }

        /* SOL NAVIGATOR (MENÜ) */
        nav { 
            width: 280px; 
            background: var(--secondary); 
            color: white; 
            height: 100vh; 
            position: fixed; 
            top: 0;
            left: 0;
            padding-top: 20px; 
            box-shadow: 2px 0 10px rgba(0,0,0,0.2); 
            z-index: 1000;
            overflow-y: auto;
        }
        nav h2 { padding: 0 20px; font-size: 1.2rem; margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; }
        nav ul { list-style: none; padding: 0; margin: 0; }
        nav ul li { padding: 15px 25px; cursor: pointer; transition: 0.3s; opacity: 0.7; font-size: 0.9rem; border-bottom: 1px solid rgba(255,255,255,0.05); }
        nav ul li:hover { background: rgba(255,255,255,0.05); opacity: 1; }
        nav ul li.active { opacity: 1; background: rgba(255,255,255,0.15); border-left: 5px solid var(--accent); font-weight: bold; }

        /* ANA İÇERİK ALANI */
        main { 
            flex: 1; 
            margin-left: 280px; 
            padding: 40px; 
            width: calc(100% - 280px);
        }

        .section { background: var(--card); padding: 35px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); display: none; margin-bottom: 40px; }
        .section.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .section-title { border-left: 5px solid var(--primary); padding-left: 15px; margin-bottom: 25px; font-size: 1.3rem; color: var(--secondary); font-weight: 700; }
        
        /* FORM ELEMANLARI */
        input, select { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px; box-sizing: border-box; transition: 0.3s; }
        input:focus, select:focus { border-color: var(--primary); outline: none; }
        
        .company-block { background: #f8fbff; border: 1px solid #e3e9ef; border-radius: 10px; padding: 25px; margin-top: 20px; position: relative; }
        
        /* BÖLÜM 5 ÖZEL TASARIM */
        .phase-card { border: 1px solid #e0e6ed; background: #ffffff; border-left: 6px solid var(--primary); padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.02); transition: 0.3s; }
        .phase-card:hover { box-shadow: 0 6px 12px rgba(0,0,0,0.05); transform: translateY(-2px); }
        .phase-header-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #f0f0f0; padding-bottom: 15px; margin-bottom: 15px; }
        .phase-badge { background: var(--primary); color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; }
        .checkbox-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; background: #fcfdfe; padding: 15px; border-radius: 6px; border: 1px dashed #ced4da; }
        .checkbox-item { display: flex; align-items: center; gap: 8px; font-size: 13px; cursor: pointer; padding: 4px; }
        .checkbox-item input { width: auto; }

        /* BUTONLAR */
        button { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: 0.3s; display: inline-flex; align-items: center; gap: 8px;}
        .btn-primary { background: var(--primary); color: white; }
        .btn-success { background: var(--accent); color: white; }
        .btn-danger { background: #d32f2f; color: white; }
        .btn-secondary { background: #78909c; color: white; }
        .btn-sm { padding: 5px 10px; font-size: 11px; }

        /* TABLOLAR */
        .table-container { overflow-x: auto; margin-top: 10px; border-radius: 8px; border: 1px solid var(--border); }
        table { width: 100%; border-collapse: collapse; min-width: 1000px; }
        th { background: var(--secondary); color: white; padding: 15px; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; }
        td { padding: 12px; border: 1px solid #eee; text-align: center; background: white; font-size: 0.9rem; vertical-align: middle; }

        /* SAYACLAR VE KUTULAR */
        .counter-row { display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee; }
        .counter-box { display: flex; align-items: center; gap: 10px; background: white; padding: 5px 10px; border-radius: 20px; border: 1px solid #ddd; }
        .val-span { font-weight: 700; color: var(--primary); min-width: 20px; text-align: center; }

        /* EXCEL DROPDOWN TASARIMI */
        .excel-dropdown { border: 1px solid #ced4da; padding: 6px 10px; border-radius: 6px; background: #fdfdfd; cursor: pointer; display: flex; justify-content: space-between; align-items: center; position: relative; font-size: 12px; min-width: 150px; text-align: left; transition: all 0.2s; color: #495057;}
        .excel-dropdown:hover { border-color: var(--primary); background: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .excel-dropdown .label-text { font-weight: 600; color: var(--primary); background: #eef2f7; padding: 2px 8px; border-radius: 4px; white-space: nowrap; }
        .excel-menu { position: absolute; top: calc(100% + 5px); left: 0; width: 220px; background: white; border: 1px solid #bbb; box-shadow: 0 10px 25px rgba(0,0,0,0.15); z-index: 5000; display: none; max-height: 250px; overflow-y: auto; border-radius: 8px; padding: 5px 0; }
        .excel-menu label { display: flex; align-items: center; padding: 10px 15px; border-bottom: 1px solid #f1f1f1; margin: 0; font-weight: 500; cursor: pointer; gap: 12px; color: #333; transition: 0.2s; }
        .excel-menu label:hover { background: #f8f9fa; color: var(--primary); }

        /* AKORDİYON */
        .process-category { margin-bottom: 15px; border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .process-header { background: #f8f9fa; padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: 0.3s; font-weight: 700; color: var(--secondary); border-bottom: 1px solid transparent; }
        .process-header:hover { background: #eceff1; }
        .process-header::after { content: '▼'; font-size: 0.8rem; transition: 0.3s; }
        .process-category.open .process-header { border-bottom: 1px solid #e0e0e0; background: #e8eaf6; }
        .process-category.open .process-header::after { transform: rotate(180deg); }
        .process-content { display: none; padding: 20px; background: white; }
        .process-category.open .process-content { display: block; }

        .hidden { display: none !important; }
        .nav-buttons { margin-top: 30px; display: flex; justify-content: space-between; border-top: 1px solid #eee; padding-top: 20px; }

        @media print {
            nav, #progress-container, .nav-buttons, button { display: none !important; }
            main { margin-left: 0; padding: 0; width: 100%; }
            .section { box-shadow: none; border: none; display: block !important; margin: 0; padding: 0; page-break-after: always; }
            .process-content { display: block !important; }
        }
    </style>
</head>
<body onclick="closeAllMenus()">

    <div id="progress-container"><div id="progress-bar"></div></div>

    <nav>
        <h2>S4Scope RFP</h2>
        <ul>
            <li onclick="validateAndShowStep(0)" id="nav-0" class="active">Bölüm 0: ERP Yapısı</li>
            <li onclick="validateAndShowStep(1)" id="nav-1">Bölüm 1: Genel Bilgiler</li>
            <li onclick="validateAndShowStep(2)" id="nav-2">Bölüm 2: Organizasyon & Yapı</li>
            <li onclick="validateAndShowStep(3)" id="nav-3">Bölüm 3: İş Süreçleri</li>
            <li onclick="validateAndShowStep(4)" id="nav-4">Bölüm 4: Teknik & Entegrasyon</li>
            <li onclick="validateAndShowStep(5)" id="nav-5">Bölüm 5: Dönüşüm Stratejisi</li>
            <li onclick="validateAndShowStep(6)" id="nav-6">Bölüm 6: Çıktı & Özet</li>
        </ul>
        <div style="position: absolute; bottom: 20px; left: 20px; width: 240px;">
            <button class="btn-danger" style="width: 100%; justify-content: center;" onclick="if(confirm('Çıkmak istediğinize emin misiniz?')) location.reload();">Çıkış Yap</button>
        </div>
    </nav>

    <main>
        <div class="section active" id="step-0">
            <div class="section-title">Bölüm 0 - Mevcut ve Hedef ERP Yapısı</div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px;">
                <div><label>Mevcut ERP Sistemi</label><select id="existingErp" onchange="toggleSapFields()"><option value="">Seçiniz</option><option value="SAP">SAP</option><option value="Oracle">Oracle</option><option value="Logo">Logo</option><option value="Microsoft Dynamics">Microsoft Dynamics</option><option value="Diğer">Diğer</option></select></div>
                <div id="sapModelArea" class="hidden"><label>Hedef SAP Modeli</label><select id="sapModel"><option value="">Seçiniz</option><option>S/4HANA OnPremise</option><option>S/4HANA Public Cloud</option><option>S/4HANA Private Cloud</option><option>ECC (Legacy)</option></select></div>
                <div id="sapVersionArea" class="hidden"><label>Mevcut SAP Versiyonu</label><input type="text" id="sapVersion" placeholder="Örn: ECC 6.0 EHP7"></div>
                <div id="approachArea" class="hidden"><label>Geçiş Yaklaşımı</label><select id="sapApproach"><option value="">Seçiniz</option><option>Greenfield (Sıfırdan)</option><option>Brownfield (Dönüşüm)</option><option>Bluefield / Hibrit</option><option>Karar verilmedi</option></select></div>
            </div>
            <div class="nav-buttons" style="justify-content: flex-end;"><button class="btn-primary" onclick="validateAndShowStep(1)">Sonraki Bölüm →</button></div>
        </div>

        <div class="section" id="step-1">
            <div class="section-title">Bölüm 1 – Şirket Bazlı Genel Bilgiler</div>
            <div style="display: flex; gap: 15px; align-items: flex-end; margin-bottom: 20px; flex-wrap: wrap;">
                <div style="flex:1; min-width: 200px;"><label>Şirket Sayısı</label><input type="number" id="companyCount" min="1" placeholder="Örn: 2"></div>
                <button class="btn-primary" onclick="createCompanies()">Oluştur</button>
                <button class="btn-success" onclick="addCompany()">+ Ekle</button>
            </div>
            <div id="companiesContainer"></div>
            <div style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
                <button class="btn-success" onclick="saveCompanies()">Kaydet</button>
                <button class="btn-primary hidden" id="modTabBtn" onclick="showModTable()">Modül Matrisi</button>
            </div>
            <div id="modTableContainer" class="table-container"></div>
            <div class="nav-buttons"><button class="btn-secondary" onclick="showStep(0)">← Geri</button><button class="btn-primary" onclick="validateAndShowStep(2)">Sonraki Bölüm →</button></div>
        </div>

        <div class="section" id="step-2">
            <div class="section-title">Bölüm 2 – Organizasyon & Yapı</div>
            <div id="orgContainer"></div>
            <div class="nav-buttons"><button class="btn-secondary" onclick="showStep(1)">← Geri</button><button class="btn-primary" onclick="validateAndShowStep(3)">Sonraki Bölüm →</button></div>
        </div>

        <div class="section" id="step-3">
            <div class="section-title">Bölüm 3 – İş Süreçleri Analizi</div>
            <div id="processArea"></div>
            <div class="nav-buttons"><button class="btn-secondary" onclick="showStep(2)">← Geri</button><button class="btn-primary" onclick="validateAndShowStep(4)">Sonraki Bölüm →</button></div>
        </div>

        <div class="section" id="step-4">
            <div class="section-title">Bölüm 4 – Teknik Entegrasyon & Yazılım Envanteri</div>
            <div id="softwareInventoryArea"></div>
            <div class="nav-buttons"><button class="btn-secondary" onclick="showStep(3)">← Geri</button><button class="btn-primary" onclick="validateAndShowStep(5)">Sonraki Bölüm →</button></div>
        </div>

        <div class="section" id="step-5">
            <div class="section-title">Bölüm 5 – Dönüşüm Stratejisi (Fazlandırma)</div>
            <div style="margin-bottom:25px;"><button class="btn-success" onclick="addNewPhase()">+ Yeni Faz Ekle</button></div>
            <div id="phasesContainer"></div>
            <div class="nav-buttons"><button class="btn-secondary" onclick="showStep(4)">← Geri</button><button class="btn-primary" onclick="validateAndShowStep(6)">Son Bölüm: Rapor →</button></div>
        </div>

        <div class="section" id="step-6">
            <div class="section-title">Bölüm 6 – RFP Özet ve Çıktı Raporu</div>
            <div id="rfpReportArea"></div>
            <div class="nav-buttons"><button class="btn-secondary" onclick="showStep(5)">← Geri</button><button class="btn-success" onclick="generateFinalReport()">Raporu Güncelle</button><button class="btn-primary" onclick="window.print()">PDF Kaydet</button></div>
        </div>
    </main>

<script>
    const sectorMap = { "Tüketici Endüstrileri": ["Tarım & Gıda", "FMCG", "İlaç", "Perakende"], "Kesikli Üretim": ["Otomotiv", "Makine Üretimi", "Savunma Sanayi"], "Süreç Endüstrileri": ["Kimya", "Petrol & Gaz", "Metal"], "Enerji ve Altyapı": ["Elektrik Dağıtım", "Su/Atık"], "Finansal Hizmetler": ["Banka", "Sigorta"], "Hizmet Endüstrileri": ["İnşaat", "Lojistik", "Turizm"] };
    const sapModules = [ "FI", "FM", "CO", "PS", "MM", "SD", "PP", "QM", "PM", "WM/EWM" ];
    const softwareGroups = { "Analitik & Finans": ["Power BI", "LucaNet", "Tableau"], "Üretim & Operasyon": ["Doruk OT", "ProManage", "MES"], "Satış & Müşteri": ["T-Soft", "Salesforce", "Magento"], "İnsan Kaynakları": ["Kolay İK", "Logo HR", "SuccessFactors"] };
    const fiWbsStructure = { "1. Organizasyon": ["1.1 Çoklu şirket kodu?", "1.2 Konsolidasyon?", "1.3 Farklı mali yıl?"], "2. GL": ["2.1 Universal Journal?", "2.2 Defter yapısı?", "2.3 Manuel yoğunluk?"], "3. AR": ["3.1 Kredi limiti?", "3.2 İhtar?", "3.3 Mutabakat?"], "4. AP": ["4.1 Fatura onayı?", "4.2 Ödeme planı?", "4.3 Avans?"], "5. Vergi": ["5.1 Otomatik KDV?", "5.2 Beyanname?", "5.3 Yasal Defter?"], "6. Sabit Kıymet": ["6.1 Sistem takibi?", "6.2 Amortisman?", "6.3 Transferler?"], "7. Kapanış": ["7.1 Reeskont?", "7.2 Kur farkı?", "7.3 Takvim?"], "8. Raporlama": ["8.1 Mali tablo?", "8.2 Fiori?", "8.3 Gerçek zamanlı?"], "9. Genel": ["9.1 Yetki?", "9.2 Log?", "9.3 Dil?"] };
    const otherModules = { "CO": ["Masraf Yeri?", "Ürün Maliyet?", "Karlılık?"], "FM": ["Bütçe kontrol?", "Taahhüt?"], "MM": ["Onaylar?", "MRP Live?"], "SD": ["Pricing?", "Kredi?"], "PP": ["MTS/MTO?", "Kapasite?"], "QM": ["Kalite kontrol?"], "PM": ["Bakım planı?"], "WM/EWM": ["Adresleme?", "Barkod?"] };
    const allProcessStructures = { ...fiWbsStructure, ...otherModules };

    let companyIndex = 0; let savedCompanies = []; let phaseCount = 0; let rowCounter = 0; 

    function toggleSapFields() { const isSap = document.getElementById("existingErp").value === "SAP"; ["sapModelArea", "sapVersionArea", "approachArea"].forEach(id => document.getElementById(id).classList.toggle("hidden", !isSap)); }
    function addCompany() { companyIndex++; const div = document.createElement("div"); div.className = "company-block"; div.innerHTML = `<button class="btn-danger btn-sm" style="position:absolute; top:15px; right:15px;" onclick="this.parentElement.remove()">✕</button><h4>Şirket #${companyIndex}</h4><div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap:15px;"><div><label>Ad</label><input type="text" class="comp-name"></div><div><label>Ülke</label><select><option>Türkiye</option><option>Diğer</option></select></div><div><label>Sektör</label><select onchange="loadSubs(this)"><option value="">Seçiniz</option>${Object.keys(sectorMap).map(s=>`<option>${s}</option>`).join("")}</select></div><div><label>Alt</label><select class="sub-sector"><option>-</option></select></div></div>`; document.getElementById("companiesContainer").appendChild(div); }
    function createCompanies() { const count = document.getElementById("companyCount").value; document.getElementById("companiesContainer").innerHTML = ""; companyIndex = 0; for(let i=0; i<count; i++) addCompany(); }
    function loadSubs(sel) { const sub = sel.parentElement.nextElementSibling.querySelector("select"); sub.innerHTML = (sectorMap[sel.value] || []).map(s=>`<option>${s}</option>`).join(""); }
    function saveCompanies() { savedCompanies = Array.from(document.querySelectorAll(".comp-name")).map(i => i.value).filter(v => v); if(savedCompanies.length) { document.getElementById("modTabBtn").classList.remove("hidden"); renderOrg(); renderProcesses(); renderTechInventory(); alert("Kaydedildi."); } }
    function showModTable() { let html = `<table><thead><tr><th>Şirket</th>${sapModules.map(m=>`<th>${m}</th>`).join("")}</tr></thead><tbody>`; savedCompanies.forEach(name => { html += `<tr><td>${name}</td>${sapModules.map(()=>`<td><input type="checkbox"></td>`).join("")}</tr>`; }); document.getElementById("modTableContainer").innerHTML = html + `</tbody></table>`; }
    function renderOrg() { let html = ""; savedCompanies.forEach((name, i) => { html += `<div class="company-block"><h4>${name} Lokasyonlar</h4>${counterRow('Üretim','p'+i)}${counterRow('Depo','w'+i)}</div>`; }); document.getElementById("orgContainer").innerHTML = html; }
    function counterRow(label, id) { return `<div class="counter-row"><span>${label}</span><div class="counter-box"><button class="btn-danger btn-sm" onclick="chgVal('${id}',-1)">-</button><span class="val-span" id="${id}">0</span><button class="btn-success btn-sm" onclick="chgVal('${id}',1)">+</button></div></div>`; }
    function chgVal(id, d) { const el = document.getElementById(id); el.innerText = Math.max(0, parseInt(el.innerText) + d); }

    function toggleExcelMenu(e, id) { e.stopPropagation(); const menu = document.getElementById(id); const isOpen = menu.style.display === 'block'; closeAllMenus(); if (!isOpen) menu.style.display = 'block'; }
    function closeAllMenus() { document.querySelectorAll('.excel-menu').forEach(m => m.style.display = 'none'); }
    function updateExcelLabel(id) { const menu = document.getElementById(id); const count = menu.querySelectorAll('input:checked').length; const lbl = document.getElementById('label-' + id); lbl.innerText = count === savedCompanies.length ? "Tüm Şirketler" : count + " Seçili"; }

    function renderProcesses() {
        let html = ""; let catIndex = 0;
        for (const [title, qs] of Object.entries(allProcessStructures)) {
            catIndex++;
            html += `<div class="process-category"><div class="process-header" onclick="this.parentElement.classList.toggle('open')">${title}</div><div class="process-content"><div class="table-container"><table><thead><tr><th>Soru</th><th>Cevap</th><th>Öncelik</th><th>Kapsam</th><th>Not</th><th>İşlem</th></tr></thead><tbody id="tbody-cat-${catIndex}">`;
            qs.forEach(q => html += generateProcessRow(q, false, false));
            html += `</tbody></table></div><button class="btn-success btn-sm" onclick="addNewProcessRow('${catIndex}')">+ Ekle</button></div></div>`;
        }
        document.getElementById("processArea").innerHTML = html;
    }

    function generateProcessRow(q, isNew, isDeletable) {
        rowCounter++; const dropId = "drop-" + rowCounter;
        return `<tr><td style="text-align:left;">${isNew ? `<input type="text">` : `<b>${q}</b>`}</td><td><select><option>-</option><option>Evet</option><option>Hayır</option></select></td><td><select><option>Normal</option><option>Kritik</option></select></td><td><div class="excel-dropdown" onclick="toggleExcelMenu(event, '${dropId}')"><span id="label-${dropId}" class="label-text">Tüm Şirketler</span> ▼<div id="${dropId}" class="excel-menu" onclick="event.stopPropagation()">${savedCompanies.map(c => `<label><input type="checkbox" checked onchange="updateExcelLabel('${dropId}')"> ${c}</label>`).join('')}</div></div></td><td><input type="text"></td><td>${isDeletable ? `<button class="btn-danger btn-sm" onclick="this.closest('tr').remove()">✕</button>` : ''}</td></tr>`;
    }
    function addNewProcessRow(id) { document.getElementById(`tbody-cat-${id}`).insertAdjacentHTML('beforeend', generateProcessRow("", true, true)); }

    function renderTechInventory() {
        let html = ""; Object.keys(softwareGroups).forEach((group, i) => {
            html += `<div class="company-block"><div style="display:flex; justify-content:space-between;"><h4>${group}</h4><div><select id="sel-soft-${i}"><option value="">Seç...</option>${softwareGroups[group].map(s=>`<option value="${s}">${s}</option>`).join("")}<option value="DİĞER">Diğer</option></select><button class="btn-success btn-sm" onclick="addSoftwareRow(${i})">Ekle</button></div></div><div class="table-container" id="cont-soft-${i}" style="display:none;"><table id="table-soft-${i}"><thead><tr><th>Yazılım</th><th>Hedef Mimari Kararı</th><th>✕</th></tr></thead><tbody id="tbody-soft-${i}"></tbody></table></div></div>`;
        });
        document.getElementById("softwareInventoryArea").innerHTML = html;
    }

    // BU KISIM DÜZELTİLDİ: Orijinal teknik seçenekler geri getirildi.
    function addSoftwareRow(i) {
        let val = document.getElementById(`sel-soft-${i}`).value; if(!val) return;
        if(val === "DİĞER") { val = prompt("Yazılım Adı:"); if(!val) return; }
        document.getElementById(`cont-soft-${i}`).style.display = "block";
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td style="font-weight:600;">${val}</td>
            <td>
                <select style="width:98%;">
                    <option>SAP Ürün/Modül/Addon ile değiştirilebilir</option>
                    <option>Hedef Mimaride kullanıma devam edilecek (Entegrasyon)</option>
                    <option>3. Parti Farklı Bir Yazılım ile değiştirilebilir</option>
                    <option>Kullanımdan kaldırılacak (Emekli edilecek)</option>
                </select>
            </td>
            <td><button class="btn-danger btn-sm" onclick="this.closest('tr').remove()">✕</button></td>`;
        document.getElementById(`tbody-soft-${i}`).appendChild(tr);
    }

    function addNewPhase() {
        phaseCount++; const div = document.createElement("div"); div.className = "phase-card";
        div.innerHTML = `<div class="phase-header-row"><span class="phase-badge">FAZ ${phaseCount}</span><input type="text" placeholder="Faz Adı"><button class="btn-danger btn-sm" onclick="this.closest('.phase-card').remove()">Sil</button></div><div style="display:grid; grid-template-columns: 1fr 2fr; gap:20px;"><div><label>Go-Live</label><input type="month"></div><div><label>Şirketler</label><div class="checkbox-grid">${savedCompanies.map(c => `<label class="checkbox-item"><input type="checkbox" class="comp-check" value="${c}"> ${c}</label>`).join("")}</div></div></div>`;
        document.getElementById("phasesContainer").appendChild(div);
    }

    function generateFinalReport() { document.getElementById("rfpReportArea").innerHTML = `<h1>RFP Özet</h1><p>Şirketler: ${savedCompanies.join(", ")}</p>`; }
    function validateAndShowStep(idx) { if(idx === 6) generateFinalReport(); showStep(idx); }
    function showStep(idx) { document.querySelectorAll(".section").forEach((s, i) => s.classList.toggle("active", i === idx)); document.querySelectorAll("nav ul li").forEach((l, i) => l.classList.toggle("active", i === idx)); document.getElementById("progress-bar").style.width = ((idx + 1) / 7 * 100) + "%"; }
</script>
</body>
</html>
